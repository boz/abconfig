---
- name: install go (pacman)
  pacaur: name={{item}}
  with_items:
    - go
    - go-tools
  when: ansible_pkg_mgr == "pacman"
  tags: [config-install,go]

- name: install go (apt)
  apt: name={{item}}
  with_items:
    - golang
  become: true
  when: ansible_pkg_mgr == "apt"
  tags: [config-install,go]

- name: create gopath
  file: path={{gopath}} state=directory
  tags: [config-install,go]

- name: configure shell $GOPATH
  template: dest={{ profiledir }}/10-gopath.sh
            src=gopath.sh
  tags: [config,go]

- name: install glide
  command: go get github.com/Masterminds/glide
  environment:
    GOPATH: "{{gopath}}"
  args:
    creates: "{{gopath}}/bin/glide"
  tags: [config-install,go,glide]

- name: install govendor
  command: go get github.com/kardianos/govendor
  environment:
    GOPATH: "{{gopath}}"
  args:
    creates: "{{gopath}}/bin/govendor"
  tags: [config-install,go,govendor]

- name: install delve
  command: go get github.com/derekparker/delve/cmd/dlv
  args:
    creates: "{{gopath}}/bin/dlv"
  environment:
    GOPATH: "{{gopath}}"
  tags: [config-install,go,delve]
